# 委托和事件
## 委托
- 委托是一种告知 C# 在触发事件时调用哪个方法的方法
- 委托是一种类型，它定义了方法的类型
- 用处
  - 在普通的方法调用中，你需要知道要调用哪个具体的方法，并使用该方法的名称来调用它。
  - 但是，在使用委托的情况下，你只需要知道要调用的方法的签名（即返回类型和参数类型）， 而不需要知道方法的具体实现。委托会在运行时动态地绑定到具体的方法，然后调用它。
  - 这种方式使得你的代码更加灵活，可以根据需要在运行时动态决定要调用的方法。
  - 另外，使用委托还可以方便地实现回调函数和事件处理等功能，这些功能在普通的方法调用中难以实现
### 声明方式 
- ps: 委托的声明和实例化要求返回值类型和参数列表必须一致
- 一是委托的声明，用来定义委托的类型；
- 二是委托的实例化，用来创建委托对象；
- 三是委托的调用，用来调用委托对象所指向的方法。
```csharp
delegate <return type> <delegate name>(<parameters>);
// <return type> 表示委托所要封装的方法的返回类型，
// <delegate name> 表示委托的名称，
// <parameters> 表示委托所要封装的方法的参数列表。
```
### 说明
- 声明
  - 再namespace 或者类下,为了外部调用一般使用public, 推荐在namespace下声明
  - delegate T type(T t) 为委托的声明
- 初始化赋值
  - type a = new type(方法名);
  - type a = 方法名;
- 调用委托变量
  - a(T类型参数);

### 系统委托(都是泛型委托)
- Action,不需要返回值,参数支持16个(in表示传入) 没有传出的参数
```csharp
// 定义一个Action类型的委托
Action<string> printMessage;

// 封装一个Lambda表达式到委托中
printMessage = (message) => Console.WriteLine(message);

// 调用委托，执行Lambda表达式
printMessage("Hello World");

```
- Func, 需要返回值, 有传出参数(out 标记),最后一个参数为返回值
```csharp
// 定义一个Func类型的委托
Func<int, int, int> addNumbers;
//  Func<in int,in int,out int>
// 封装一个方法到委托中
addNumbers = (x, y) => x + y;

// 调用委托，执行方法
int result = addNumbers(2, 3);
Console.WriteLine(result); // 输出：5

```
- Action和Func都是泛型委托类型，因此需要指定具体的参数类型和返回值类型。另外，Action和Func还支持重载，可以有不同的参数和返回值类型组合，以适应不同的需求。

### (组播)多播委托(委托的意义)
- 将多个函数对象分配到一个委托对象上，当这个委托被调用时，这些函数对象就会被依次调用
- 一个合并委托调用它所合并的两个委托。只有相同类型的委托可被合并
- 通过 = += -=进行添 和 删除 委托 (= 不推荐)
- **实战:**
  - 委托函数类型返回值推荐使用void
  - 委托为空时,调用会报错,可以使用?.进行判断
  - 配合反射,可以实现动态调用
  - 委托的参数类型可以是object, 但是调用时需要强制转换
  - 委托的参数类型可以是泛型, 但是调用时需要指定泛型类型
